"use strict";(self.webpackChunkgreenfield_js_sdk_docs=self.webpackChunkgreenfield_js_sdk_docs||[]).push([[285],{1286:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>x,frontMatter:()=>i,metadata:()=>d,toc:()=>l});var s=n(5250),a=n(5285);const i={id:"tx-client",sidebar_position:1,title:"Tx Client"},r=void 0,d={id:"client/tx-client",title:"Tx Client",description:"About Tx",source:"@site/docs/client/tx-client.mdx",sourceDirName:"client",slug:"/client/tx-client",permalink:"/greenfield-js-sdk/client/tx-client",draft:!1,unlisted:!1,editUrl:"https://github.com/bnb-chain/greenfield-js-sdk/tree/main/doc-site/docs/client/tx-client.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"tx-client",sidebar_position:1,title:"Tx Client"},sidebar:"GettingStartSidebar",previous:{title:"Greenfield Client",permalink:"/greenfield-js-sdk/client/greenfield-client"},next:{title:"Query Client",permalink:"/greenfield-js-sdk/client/query-client"}},c={},l=[{value:"About Tx",id:"about-tx",level:2},{value:"simulate",id:"simulate",level:2},{value:"broadcast",id:"broadcast",level:2},{value:"Example",id:"example",level:2},{value:"1. construct a transaction",id:"1-construct-a-transaction",level:3},{value:"2. simulate",id:"2-simulate",level:3},{value:"3. broadcast",id:"3-broadcast",level:3}];function o(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"about-tx",children:"About Tx"}),"\n",(0,s.jsx)(t.p,{children:"A transaction contains at least:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"construct a transaction: The sdk already provides each transaction type"}),"\n",(0,s.jsxs)(t.li,{children:["simulate: ",(0,s.jsx)(t.a,{href:"#simulate",children:"txClient.simulate"})]}),"\n",(0,s.jsxs)(t.li,{children:["broadcast ",(0,s.jsx)(t.a,{href:"#broadcast",children:"txClient.broadcast"})]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"simulate",children:"simulate"}),"\n",(0,s.jsx)(t.p,{children:"Just Simulate a transaction and valid transaction."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"params"}),(0,s.jsx)(t.th,{children:"description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"denom"}),(0,s.jsx)(t.td,{children:"the coin denom to query balances for"})]})})]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'title="simulate tx"',children:"// `tx` is a transaction constructed by the sdk\nconst simulateInfo = await tx.simulate({\n  denom: 'BNB',\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"broadcast",children:"broadcast"}),"\n",(0,s.jsx)(t.p,{children:"Broadcast the transaction to the chain."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"params"}),(0,s.jsx)(t.th,{children:"description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"denom"}),(0,s.jsx)(t.td,{children:"the coin denom to query balances for"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"gasLimit"}),(0,s.jsxs)(t.td,{children:["can be set to any number, but not too small or the transaction may fail (recommended use ",(0,s.jsx)(t.code,{children:"simulateInfo.gasLimit"}),")"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"gasPrice"}),(0,s.jsx)(t.td,{children:"1 unit of Gas that the transaction sender is willing to pay."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"payer"}),(0,s.jsx)(t.td,{children:"transaction sender"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"granter"}),(0,s.jsxs)(t.td,{children:["transaction ganter (Generally empty ",(0,s.jsx)(t.code,{children:"''"}),")"]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"signTypedDataCallback"}),(0,s.jsxs)(t.td,{children:["broadcast use ",(0,s.jsx)(t.code,{children:"window.ethereum"})," as signature provider by default."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"privateKey"}),(0,s.jsx)(t.td,{children:"If you broadcast in Nodejs, you can broadcast a tx by privateKey"})]})]})]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'title="broadcast tx"',children:"// broadcast tx\nconst broadcastRes = await transferTx.broadcast({\n  denom: 'BNB',\n  gasLimit: Number(simulateInfo.gasLimit),\n  gasPrice: simulateInfo.gasPrice,\n  payer: '0x0000000000000000000000000000000000000001',\n  granter: '',\n});\n"})}),"\n",(0,s.jsxs)(t.admonition,{type:"tip",children:[(0,s.jsxs)(t.p,{children:["If you want to use others wallet, you can set ",(0,s.jsx)(t.code,{children:"signTypedDataCallback"}),":"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:"// trustwallet:\nconst broadcastRes = await transferTx.broadcast({\n  // ...\n  signTypedDataCallback: async (addr: string, message: string) => {\n    return await window.trustwallet.request({\n      method: 'eth_signTypedData_v4',\n      params: [addr, message],\n    });\n  },\n});\n"})}),(0,s.jsx)(t.p,{children:"If you broadcast in Nodejs, you can broadcast a tx by privateKey:"}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:"const broadcastRes = await transferTx.broadcast({\n  // ...\n  privateKey: '0x.......',\n});\n"})})]}),"\n",(0,s.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,s.jsxs)(t.p,{children:["Take ",(0,s.jsx)(t.code,{children:"transfer"})," tx as an example."]}),"\n",(0,s.jsx)(t.h3,{id:"1-construct-a-transaction",children:"1. construct a transaction"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'title="construct tx"',children:"const transferTx = await client.account.transfer({\n  fromAddress: address,\n  toAddress: transferInfo.to,\n  amount: [\n    {\n      denom: 'BNB',\n      amount: '1000000000',\n    },\n  ],\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"2-simulate",children:"2. simulate"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'title="simulate tx"',children:"const simulateInfo = await transferTx.simulate({\n  denom: 'BNB',\n});\n"})}),"\n",(0,s.jsx)(t.h3,{id:"3-broadcast",children:"3. broadcast"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",metastring:'title="broadcast tx"',children:"const broadcastRes = await transferTx.broadcast({\n  denom: 'BNB',\n  gasLimit: Number(simulateInfo.gasLimit),\n  gasPrice: simulateInfo.gasPrice,\n  payer: address,\n  granter: '',\n});\n"})})]})}function x(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},5285:(e,t,n)=>{n.d(t,{Z:()=>d,a:()=>r});var s=n(79);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);